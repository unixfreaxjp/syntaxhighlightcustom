<!DOCTYPE html>
<html dir="ltr" lang="en-gb"><!-- Mirrored from www.kernelmode.info/forum/viewtopic.php?f=16&t=3099 , Sun, 01 Dec 2019 16:50:34 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><!-- /Added by HTTrack -->

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="designer" content="SiteSplat https://themeforest.net/user/themesplat/portfolio?ref=ThemeSplat">
<meta content="KernelMode.info" property="og:site_name">
<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

<title>Linux/Elknot (Windows DDoS botnet, alias DnsAmp)&nbsp;-&nbsp;KernelMode.info</title>

	<link rel="canonical" href="https://www.kernelmode.info/forum/viewtopic66d7.html?t=3099">

<!-- Google free font here -->
<link href="kmdata/css.css" rel="stylesheet">
<link href="kmdata/css_002.css" rel="stylesheet">

<!-- CSS files start here -->
<link href="kmdata/stylesheet.css" rel="stylesheet">
<link href="kmdata/plupload.css" rel="stylesheet">


<link href="kmdata/minicms6846.css" rel="stylesheet" media="screen">


<!-- Remove the conditional below to use the custom CSS without FLATBOOTS Mini CMS Extension -->
<link href="kmdata/custom.css" rel="stylesheet">
<!-- CSS files stop here -->


<!-- older scripts set started here after the headjs - cannot do this with phpbb31 due to ajax stuff -->
<script src="kmdata/head.htm"></script>

</head>
<body data-spy="scroll" data-target=".scrollspy" id="phpbb" class="section-viewtopic ltr ">

<div id="wrap" class="corners container-fluid">
  <!-- start content -->
  <div id="content-forum">
    <div class="padding_0_40">
	    		<div class="social-top">
		<div class="pull-right">
							<a title="Delete Cookies" data-original-title="" href="https://www.kernelmode.info/forum/ucp033a.html?mode=delete_cookies" target="_blank"><i class=""></i></a>
					</div>
	</div>
    	
<!-- Header block -->
    <header class="header"> 
     <div class="topArea"> <!-- Logo block -->
	  <div class="leftArea">
		  		  <div class="logo-transition">
			<a class="logo" href="https://www.kernelmode.info/forum/index-2.html">KernelMode.info - Archive</a>
          </div>		 
		 		 <p class="site-info">A forum for reverse engineering, OS internals and malware analysis&nbsp;<i class="fa fa-umbrella"></i></p>
		<div class="clearfix"></div>
	  </div> 


<!-- MOBILE Navigation block -->
<!-- Everything you want hidden at 940px or less, place within here -->
    <nav class="hidden-lg hidden-md hidden-sm">
	 <div id="responsive-navigation" class="collapse">
		<ul class="flexnav list-unstyled">
		      	      <li><a href="#"><i class="fa fa-comments"></i> Forum</a></li>
	      			<!-- Remove ext links -->
				<!-- Remove ext links -->
        </ul>
	  </div>
    </nav> 
<!-- MOBILE Navigation block -->             </div>
    </header> 
<!-- Header block -->

		   <div style="border-bottom: 1px solid #CCCCCC;"></div>
		
	
		
<!-- Lower Breadcrumb block -->
		<div class="sub-breadcrumb">
            
                    </div>
<!-- Lower Breadcrumb block --> 
	
		
	<div id="page-body">
	
	    <div class="side-segment"><h3><a href="https://www.kernelmode.info/forum/viewtopic54df.html?f=16&amp;t=3099">Linux/Elknot (Windows DDoS botnet, alias DnsAmp)</a></h3></div>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none;">Forum for analysis and discussion about malware.<br></div>





<div class="col-md-8">
  <div class="pull-right">	 
     <ul class="pagination pagination-sm hidden-xs">
		 <li class="active"><a>53 posts</a></li>
		 					
		<li class="active"><a>1</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd5fe.html?f=16&amp;t=3099&amp;start=10" role="button">2</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopic1c19-2.html?f=16&amp;t=3099&amp;start=20" role="button">3</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopiccaa5-2.html?f=16&amp;t=3099&amp;start=30" role="button">4</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopic9f02.html?f=16&amp;t=3099&amp;start=40" role="button">5</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd726.html?f=16&amp;t=3099&amp;start=50" role="button">6</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd5fe.html?f=16&amp;t=3099&amp;start=10" rel="next" role="button">Next</a></li>
	
		     </ul>
	
	<div class="visible-xs"> 
     <ul class="pagination pagination-sm">
		<li class="active"><a>53 posts</a></li>		</ul>
	</div>
  </div>
</div> 

</div>



<div class="space10"></div>
 <div class="space10"></div>

 

  <div id="p21783" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p21783">Linux/Elknot (Windows DDoS botnet, alias DnsAmp)</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopic2ccf.html?p=21783#p21783" title="Post">#21783</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist857d.html?mode=viewprofile&amp;u=5860" style="color: #595959;" class="username-coloured">teddybear</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Tue Dec 24, 2013 6:59 pm 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content21783">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content"><a href="http://www.cert.pl/news/7849/langswitch_lang/en" class="postlink">http://www.cert.pl/news/7849/langswitch_lang/en</a><br>
<br>
Linux samples from these URLs are in attachment:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>hxxp://www.dgnfd564sdf.com:8080/atdd
hxxp://www.dgnfd564sdf.com:8080/cupsdd
hxxp://www.dgnfd564sdf.com:8080/ksapd
hxxp://www.dgnfd564sdf.com:8080/sksapd
hxxp://www.dgnfd564sdf.com:8080/kysapd
hxxp://www.dgnfd564sdf.com:8080/skysapd
</code></pre></div>

ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, for GNU/Linux 2.2.5, not stripped</div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/file6060.php?id=7171">linux_ddos.7z</a></div>
			<small><i class="fa fa-pencil"></i> infected</small><br>			<small><i class="fa fa-download"></i> (767.95 KiB) Downloaded 165 times</small>
		</div>
		
								</div>
										</div>
										
																					<div class="notice text-muted">
						 <small>Last edited by <a href="https://www.kernelmode.info/forum/memberlist913b.html?mode=viewprofile&amp;u=55" style="color: #00BF00;" class="username-coloured">EP_X0FF</a> on Thu Sep 11, 2014 12:22 am, edited 2 times in total.</small>
						 <small><strong>Reason:</strong>&nbsp;title edit</small>						 <div><small></small></div>
						</div>
																
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile21783">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist857d.html?mode=viewprofile&amp;u=5860"><img class="img-rounded avatar" src="kmdata/file97a8.jpg" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist857d.html?mode=viewprofile&amp;u=5860" style="color: #595959;" class="username-coloured">teddybear</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						16
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Tue Sep 24, 2013 11:06 am
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p21816" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p21816">Re: Linux/Windows DDoS botnet</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopicd557-2.html?p=21816#p21816" title="Post">#21816</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist857d.html?mode=viewprofile&amp;u=5860" style="color: #595959;" class="username-coloured">teddybear</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Sun Dec 29, 2013 3:36 pm 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content21816">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content">I would like to thank @unixfreakjp for the nice writing here:<br>
<a href="http://malwaremustdie.blogspot.it/2013/12/lets-be-more-serious-about-dns-amp-elf.html" class="postlink">http://malwaremustdie.blogspot.it/2013/ ... p-elf.html</a></div>
					
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile21816">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist857d.html?mode=viewprofile&amp;u=5860"><img class="img-rounded avatar" src="kmdata/file97a8.jpg" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist857d.html?mode=viewprofile&amp;u=5860" style="color: #595959;" class="username-coloured">teddybear</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						16
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Tue Sep 24, 2013 11:06 am
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p22312" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p22312">DoS:Linux/Elknot.C</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopic6a9e.html?p=22312#p22312" title="Post">#22312</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlistdf70.html?mode=viewprofile&amp;u=1597" style="color: #595959;" class="username-coloured">onthar</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Wed Feb 26, 2014 3:09 pm 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content22312">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content">A new linux ddos-bot. Spreading via bruteforced ssh<br>
More info: <a href="http://habrahabr.ru/post/213973/" class="postlink">http://habrahabr.ru/post/213973/</a><br>
<br>
<br>
<a href="https://www.virustotal.com/ru/file/1ad826066e9a74b7a703c2bb25c9ba320de7fde61a22b3b32f516014b5083db1/analysis/1393426521/" class="postlink">xfsdxd md5:441ab8542f9aab3cee0b9e0db35a3ed8</a><br>
<a href="https://www.virustotal.com/ru/file/48c5ba170a2aca2ce62f9a032a569d55ed2a36448119a396113d025f9888c44a/analysis/1393426402/" class="postlink">ksapdd md5:3788a1f0d003114ecb95f70575edc431</a><br>
<a href="https://www.virustotal.com/ru/file/cd968cd4492e7ae87e1d91d62b31314a69eb7d205f8fa6155b9f755937bcd6d8/analysis/1393427052/" class="postlink">kysapdd md5:7288222f5481e761e9c5ce3680861e84</a><br>
<a href="https://www.virustotal.com/ru/file/13f13f4e214c2755235ba36643e4ab08d4ea679da008397b7a540e0d45e70ab2/analysis/1393427052/" class="postlink">atddd md5:5dc3c90df617d1789fa96308abbf82ca</a><br>
<a href="https://www.virustotal.com/ru/file/682e7668b3e9314681b1b70ac3c4d2a5a890fc966c59d9d36851acee61398438/analysis/1393427059/" class="postlink">skysapdd md5:3f5c73745f7c17702bac0642a85d7d80</a></div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/file8d5a.php?id=7366">etc.zip</a></div>
			<small><i class="fa fa-pencil"></i> pw: infeted</small><br>			<small><i class="fa fa-download"></i> (2.64 MiB) Downloaded 137 times</small>
		</div>
		
								</div>
										</div>
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile22312">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlistdf70.html?mode=viewprofile&amp;u=1597"><img class="img-rounded avatar" src="kmdata/filee758.png" alt="User avatar" height="68" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlistdf70.html?mode=viewprofile&amp;u=1597" style="color: #595959;" class="username-coloured">onthar</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						17
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Wed Jun 01, 2011 9:03 pm
					</div>
				</div>
								
				
								
																																<div class="user-profile-row">
					    <div class="user-profile-tag">Location</div>
				    <div class="user-profile-output">
						Russia
					</div>
				</div>
																
							    				<div class="user-profile-row">
					<div class="user-profile-tag">Contact</div>
					<div class="user-profile-output-contact">
							<ul class="mini-profile-contact list-inline text-center">
															 																																<li><a class="btn btn-xs btn-default" href="https://www.icq.com/people/3470670/" title="ICQ">
								 <i class="fa fa-phpbb_icq"></i>
								 </a>
								</li>
																							 																								<li><a class="btn btn-xs btn-default" href="http://virlab.su/" title="Website">
								 <i class="fa fa-phpbb_website"></i>
								 </a>
								</li>
																														</ul>
					</div>
				</div>
												
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p23855" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p23855">Linux/DnsAmp</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopice41d-2.html?p=23855#p23855" title="Post">#23855</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Wed Sep 10, 2014 8:39 pm 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content23855">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content">My first post for this threat was started in here. This is NOT "IptabLes|x" and NOT "BillGates" one.<br>
<a href="http://blog.malwaremustdie.org/2013/12/lets-be-more-serious-about-dns-amp-elf.html" class="postlink">http://blog.malwaremustdie.org/2013/12/ ... p-elf.html</a><br>
After a while it was improved with x64 samples so I write again with ways to reverse this here:<br>
<a href="http://blog.malwaremustdie.org/2014/05/linux-reversing-is-fun-toying-with-elf.html" class="postlink">http://blog.malwaremustdie.org/2014/05/ ... h-elf.html</a><br>
Is being used as reference i.e.here:<br>
<a href="http://www.cert.at/services/blog/20140709151301-1191_en.html" class="postlink">http://www.cert.at/services/blog/201407 ... 91_en.html</a><br>
<br>
This threat is DDoS'er, among other functions, like backdoor etc. 
Originally from China network. AV commonly naming this variant as 
Mayday, Elknot, or DDoS.x This samples &amp; actors was spotted when 
they are first started to implement the DNS/Amplification function. 
Samples tested are:<br>
Filename: disknyp: <a href="https://www.virustotal.com/en/file/9e2fe126cf7714869ecd459eb76c04e1589ac74d461208edec828b261d5432c5/analysis/" class="postlink">https://www.virustotal.com/en/file/9e2f ... /analysis/</a>
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code> // netstat of CNC
 tcp        0      0 127.0.0.1:xxx                0.0.0.0:*                   LISTEN      -                  
 tcp        0     27 diemoronz.mmd.org:39445     190.115.20.27:59870         ESTABLISHED 7391/disknyp &lt;=== w000t!!!</code></pre></div>
Filename: ms20: <a href="https://www.virustotal.com/en/file/ea7b6cebdac78a42e1b4f5073c125e974e9da8ee7c5a4604be57061332ad93c3/analysis/" class="postlink">https://www.virustotal.com/en/file/ea7b ... /analysis/</a>
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>// netstat of CNC 
 ms20      13858    operator    3u     IPv4     685671      TCP MMD:38016-&gt;190.115.20.11:59870 (ESTABLISHED) &lt;=== W000T!!!
// PSH,ACK sent as beacon (pcap):
 0.000000        x.x.x.x 190.115.20.11   TCP     93      38016 &gt; 59870 [PSH, ACK] Seq=1 Ack=1 Win=1460 Len=27 TSval=2115940204 TSecr=1159829</code></pre></div>
CNC callbacks (at that time , in these samples) were all hard coded in 
the ELF, proven by the test, went to the "ddos-guard.net" , looks like 
that time this DDoS actor is hiding behind an Anti-DDoS service. 
Recently are calling back to the Chinese HFS web server panels whree it 
was served.<br>
<br>
The way this variant is hiding their CNC is by a typical obfuscation 
they called it as "crypting", advice:  maybe it would be better make 
sigs by the "CUtility::DeCrypt" logic, I made my own scanner for 
detecting this variant among bunch of samples successfully, why AV dont 
do similar?
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>.text:0x805094E push    offset a281206302 ; "281-206-3//02" &lt;=== IP address "encrypted"
.text:0x8050953 push    0FFh
.text:0x8050958 lea     eax, [ebp+var_10C]
.text:0x805095E push    eax
.text:0x805095F call    _ZN8CUtility7DeCryptEPciPKci ; CUtility::DeCrypt(char *,int,char  const*,int) &lt;== decrypt IP
.text:0x8050964 add     esp, 10h
.text:0x8050967 push    0Ah
.text:0x8050969 push    offset a68961   ; "68961" &lt;=== Port number "encrypted"
.text:0x805096E push    0FFh
.text:0x8050973 lea     eax, [ebp+var_20C]
.text:0x8050979 push    eax
.text:0x805097A call    _ZN8CUtility7DeCryptEPciPKci ; CUtility::DeCrypt(char *,int,char  const*,int)  &lt;== decrypt port
.text:0x805097F add     esp, 10h
.text:0x8050982 sub     esp, 0Ch
.text:0x8050985 lea     eax, [ebp+var_5]
.text:0x8050988 push    eax</code></pre></div>Hashes:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>MD5 (disknyp) = 260533ebd353c3075c9dddf7784e86f9
MD5 (m20) = 7348efce3d373ee1a3ac18c6c0796a84
(and some two recent ones..</code></pre></div>

Additional: <br>
*) An analysis log of one spotted in July 2014; <a href="http://pastebin.com/dhvAEH4D" class="postlink">http://pastebin.com/dhvAEH4D</a><br>
    Sample: <a href="https://www.virustotal.com/en/file/19034c5fa31299e1d50e610dc3389d08db064d0c2a0aa1fb0bab0858532cd9c5/analysis/1406548491/" class="postlink">https://www.virustotal.com/en/file/1903 ... 406548491/</a><br>
<br>
<a href="http://malwaremustdie.org/" class="postlink">malwaremustdie.org</a></div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/file6037.php?id=7809">samples.7z</a></div>
			<small><i class="fa fa-pencil"></i> 7z,pwd:infected</small><br>			<small><i class="fa fa-download"></i> (1.23 MiB) Downloaded 88 times</small>
		</div>
		
								</div>
										</div>
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile23855">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815"><img src="kmdata/9c64b2fac870b9970a34651e3db5fe06.png" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						501
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Thu Apr 12, 2012 4:53 pm
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p23858" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p23858">Re: Linux/Elknot (DDoS botnet, alias DnsAmp)</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopic4f47-2.html?p=23858#p23858" title="Post">#23858</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Thu Sep 11, 2014 2:45 am 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content23858">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content">The threat is improving. Now the obfuscation technique. This explanation is in this real PoC. <br>
Sample: (attached)
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>-rwxr--r--   1 mmd mmd  2492148 Jul 20 06:47 txmap*
$ md5 txmap
MD5 (txmap) = 917a2a3d8c30282acbe7b1ff121a4336</code></pre></div><a href="https://www.virustotal.com/en/file/92c87b7bddb66de8a5a27d944b5d4b46c59b38047b8a5fc381118c615c3775f9/analysis/1406605801/" class="postlink">https://www.virustotal.com/en/file/92c8 ... 406605801/</a><br>
Static analysis:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>File size 2.4 MB ( 2492148 bytes )
File type ELF, Magic literal
ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), 
statically linked, for GNU/Linux 2.6.9, stripped
FileAccessDate
   2014:07:20 00:17:03+01:00
FileCreateDate
   2014:07:20 00:17:03+01:00

ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           Intel 80386
  Version:                           0x1
  Entry point address:               0x8048130
  Start of program headers:          52 (bytes into file)
  Start of section headers:          2491188 (bytes into file)
  Flags:                             0x0
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         5
  Size of section headers:           40 (bytes)
  Number of section headers:         24
  Section header string table index: 23

Section Headers:
  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0
  [ 1] .note.ABI-tag     NOTE            080480d4 0000d4 000020 00   A  0   0  4
  [ 2] .init             PROGBITS        080480f4 0000f4 000030 00  AX  0   0  4
  [ 3] .text             PROGBITS        08048130 000130 0bde0c 00  AX  0   0 16
  [ 4] __libc_freeres_fn PROGBITS        08105f40 0bdf40 000ffa 00  AX  0   0 16
  [ 5] .fini             PROGBITS        08106f3c 0bef3c 00001c 00  AX  0   0  4
  [ 6] .rodata           PROGBITS        08106f60 0bef60 018720 00   A  0   0 32
  [ 7] __libc_subfreeres PROGBITS        0811f680 0d7680 00002c 00   A  0   0  4
  [ 8] __libc_atexit     PROGBITS        0811f6ac 0d76ac 000004 00   A  0   0  4
  [ 9] .eh_frame         PROGBITS        0811f6b0 0d76b0 0195b0 00   A  0   0  4
  [10] .gcc_except_table PROGBITS        08138c60 0f0c60 004725 00   A  0   0  4
  [11] .tdata            PROGBITS        0813e388 0f5388 000010 00 WAT  0   0  4
  [12] .tbss             NOBITS          0813e398 0f5398 000020 00 WAT  0   0  4
  [13] .ctors            PROGBITS        0813e398 0f5398 000024 00  WA  0   0  4
  [14] .dtors            PROGBITS        0813e3bc 0f53bc 00000c 00  WA  0   0  4
  [15] .jcr              PROGBITS        0813e3c8 0f53c8 000004 00  WA  0   0  4
  [16] .data.rel.ro      PROGBITS        0813e3e0 0f53e0 000814 00  WA  0   0 32
  [17] .got              PROGBITS        0813ebf4 0f5bf4 000078 04  WA  0   0  4
  [18] .got.plt          PROGBITS        0813ec6c 0f5c6c 00000c 04  WA  0   0  4
  [19] .data             PROGBITS        0813ec80 0f5c80 16a0f4 00  WA  0   0 32
  [20] .bss              NOBITS          082a8d80 25fd74 007748 00  WA  0   0 32
  [21] __libc_freeres_pt NOBITS          082b04c8 25fd74 000014 00  WA  0   0  4
  [22] .comment          PROGBITS        00000000 25fd74 0004da 00      0   0  1
  [23] .shstrtab         STRTAB          00000000 26024e 0000e4 00      0   0  1

Program Headers:
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
  LOAD           0x000000 0x08048000 0x08048000 0xf5385 0xf5385 R E 0x1000
  LOAD           0x0f5388 0x0813e388 0x0813e388 0x16a9ec 0x172154 RW  0x1000
  NOTE           0x0000d4 0x080480d4 0x080480d4 0x00020 0x00020 R   0x4
  TLS            0x0f5388 0x0813e388 0x0813e388 0x00010 0x00030 R   0x4
  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RWE 0x4

 Section to Segment mapping:
  Segment Sections...
   00     .note.ABI-tag .init .text __libc_freeres_fn .fini .rodata __libc_subfreeres __libc_atexit .eh_frame .gcc_except_table 
   01     .tdata .ctors .dtors .jcr .data.rel.ro .got .got.plt .data .bss __libc_freeres_ptrs 
   02     .note.ABI-tag 
   03     .tdata .tbss 

There are no section groups in this file.
There is no dynamic section in this file.
There are no relocations in this file.
There are no unwind sections in this file.
No version information found in this file.

Notes at offset 0x000000d4 with length 0x00000020:
  Owner		Data size	Description
  GNU		0x00000010	NT_VERSION (version)</code></pre></div>
Source code filenames:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>Fake.cpp
Global.cpp
main.cpp
Manager.cpp
ServerIP.cpp
StatBase.cpp
ThreadAttack.cpp
ThreadHostStatus.cpp
ThreadTaskManager.cpp
ThreadTimer.cpp
AutoLock.cpp
FileOp.cpp
Log.cpp
Md5.cpp
Media.cpp
NetBase.cpp
ThreadCondition.cpp
Thread.cpp
ThreadMutex.cpp
Utility.cpp</code></pre></div>
path accessed:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>/bin/sh
/cpuinfo
/dev/console
/dev/full
/dev/log
/dev/null
/dev/tty
/etc/fstab
/etc/host.conf
/etc/ld.so.cache
/etc/localtime
/etc/mtab
/etc/nsswitch.conf
/etc/resolv.conf
/etc/suid-debug
/gcof
/lib/
/lib/obsolete/linuxthreads/
/loc
/locale.alias
/meminfo
/proc
/proc/
/proc/%d/exe
/proc/cpuinfo
/proc/cpuinfo
/proc/meminfo
/proc/net
/proc/net/dev
/proc/self/exe
/proc/self/exe
/proc/self/maps
/proc/self/maps
/proc/stat
/proc/stat
/proc/sys/kernel/ngroups_max
/proc/sys/kernel/ngroups_max
/proc/sys/kernel/osrelease
/proc/sys/kernel/osrelease
/proc/sys/kernel/rtsig-max
/proc/sys/kernel/rtsig-max
/proc/sys/kernel/version
/staf
/usr
/usr/lib/
/usr/lib/gconv
/usr/lib/gconv/gconv-modules.cache
/usr/lib/locale
/usr/lib/locale/locale-archive
/usr/libexec/getconf
/usr/lib/gconv/gconv-modules.cache
/usr/lib/locale
/usr/lib/locale/locale-archive
/usr/libexec/getconf
/usr/share/locale
/usr/share/zoneinfo
/var/profile
/var/run/nscd/socket
/var/tmp</code></pre></div>
Compilation &amp; dependency
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>// Where it was compiled:
GCC: (GNU) 4.0.0 20050519 (Red Hat 4.0.0-8)
GCC: (GNU) 4.0.0 20050519 (Red Hat 4.0.0-8)
GCC: (GNU) 4.0.0 20050519 (Red Hat 4.0.0-8)
GCC: (GNU) 4.0.0 20050519 (Red Hat 4.0.0-8)
GCC: (GNU) 4.0.0 20050519 (Red Hat 4.0.0-8)
// And the compat:
GCC: (GNU) 4.2.1
// Libs needed:
ld.so-1.7.0
/etc/ld.so.cache
glibc-ld.so.cache1.1</code></pre></div>
Same lang traces, same environment:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>.data:08223C38 aINZD db 'ｴｴｽｨﾔｭﾊｼﾌﾗｽﾓﾗﾖﾊｧｰﾜ(%d)',0Dh,0Ah,0</code></pre></div>
In reversing this type. You cannot see what it is without a good disassembler tool. Not as per previous post.<br>
Because functions are-address based, it is obfuscated (tons of tools can make it, donno which one is used, but who cares..)<br>
If you go to EP: start() to be hammered by these pushed subroutines:
 <div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code> xor     ebp, ebp
  pop     esi
  mov     ecx, esp
  and     esp, 0FFFFFFF0h
  push    eax
  push    esp
  push    edx
  push    offset sub_80A9700
  push    offset sub_80A9740
  push    ecx
  push    esi
  push    offset sub_804826</code></pre></div>This is a kind of signature, for me.<br>
In my way, figured each function one by one, trail it until you meet the static call of kernel syscall and make the table of it.<br>
Put it back the table of syscall to the opcodes addess, you can trail how it works like;
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>Go to: sub_80A8FC0 start! ;; obviously.. a start.
Go to: sub_80D8380 switch ;; 31 cases: 0x21, 0x20, 17, 11, 6, 10, E, D , C ,B , 5, 3
Go to: sub_80D4290 LINUX - sys_newuname
Go to: loc_80A91E8 Read: "/proc/sys/kernel/osrelease"
Go to: sub_80D5450 LINUX - sys_read
(and so on..)</code></pre></div>This way I can confirm the similarity to confirm this family.<br>
<br>
I use many breakpoint to debug the malware (sorry, since crooks maybe read this I cant explain "how")<br>
The concept is launched the parrent, put the break point right after the forking about to be started:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>execve("./MALWARE", ["./MALWARE"], [/* 16 vars */]) = 0
uname({sys="Linux", node="1x111", ...}) = 0
brk(0)                                  = 0x90fc000
brk(0x90fccb0)                          = 0x90fccb0
set_thread_area(0xfff95c2c)             = 0
brk(0x911dcb0)                          = 0x911dcb0
brk(0x911e000)                          = 0x911e000
readlink("/proc/self/exe", "../mmd/test/MALWARE", 1024) = 18
rt_sigaction(SIGINT, {SIG_IGN, [], 0}, {SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGQUIT, {SIG_IGN, [], 0}, {SIG_DFL, [], 0}, 8) = 0
rt_sigprocmask(SIG_BLOCK, [CHLD], [], 8) = 0
clone(child_stack=0, flags=CLONE_PARENT_SETTID|SIGCHLD, parent_tidptr=0xfff94ff4) = 28481
waitpid(28481, [{WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) == 0}], 0) = 28481
rt_sigaction(SIGINT, {SIG_DFL, [], 0}, NULL, 8) = 0
rt_sigaction(SIGQUIT, {SIG_DFL, [], 0}, NULL, 8) = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
--- SIGCHLD (Child exited) @ 0 (0) ---
clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0) = 28483
rt_sigaction(SIGINT, {SIG_IGN, [], 0}, {SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGQUIT, {SIG_IGN, [], 0}, {SIG_DFL, [], 0}, 8) = 0
rt_sigprocmask(SIG_BLOCK, [CHLD], [], 8) = 0
clone(child_stack=0, flags=CLONE_PARENT_SETTID|SIGCHLD, parent_tidptr=0xfff94ff4) = 28484
waitpid(28484, [{WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) == 0}], 0) = 28484
rt_sigaction(SIGINT, {SIG_DFL, [], 0}, NULL, 8) = 0
rt_sigaction(SIGQUIT, {SIG_DFL, [], 0}, NULL, 8) = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
--- SIGCHLD (Child exited) @ 0 (0) ---
clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0) = 28486
exit_group(0)  // &lt;==== Put breakpoint before forking started</code></pre></div>
Make sure the new process:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>// examine:
// new process forked:
29547 ?        Ssl    0:00 (MALWARE)</code></pre></div>
Let it run abit after you see list of files sockets goes like this:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>MALWARE 28756  mmd  cwd    DIR     9,2     4096 29757163 /home/mmd/test
MALWARE 28756  mmd  rtd    DIR     9,2     4096        2 /
MALWARE 28756  mmd  txt    REG     9,2  1480387 29763093 /home/mmd/test/MALWARE (deleted)
MALWARE 28756  mmd    0u   CHR     1,3      0t0     1027 /dev/null
MALWARE 28756  mmd    1u   CHR     1,3      0t0     1027 /dev/null
MALWARE 28756  mmd    2u   CHR     1,3      0t0     1027 /dev/null</code></pre></div>Break it here to record the registers.<br>
And then release the breakpoint, and you will see the INET connection 
started in debug codes, and also in monitor like below, question is 
...what's the different with the process above?? See below too:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>MALWARE     29547 mmd    3u  IPv4 7932614      0t0      TCP serpico.malwaremustdie.org:60162-&gt;183.60.202.59:10991 (ESTABLISHED)</code></pre></div>Confirm it by checking the socket:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>tcp        0     27 x.x.x.x:60224       183.60.202.59:10991     ESTABLISHED 29547/</code></pre></div>Voila!
 you see the same PID shown in the next fork that had just started. This
 shows INET won't be started as parent mode but as child, good reversing
 information.<br>
PS: CNC Information: China!
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>$ echo 183.60.202.59 | bash /malware/checkdomains/origin.sh
183.60.202.59||4134 | 183.0.0.0/10 | CHINANET | CN | CHINATELECOM.COM.CN | CHINANET GUANGDONG PROVINCE NETWORK</code></pre></div>
And after waiting a little while some attacks will start, one of the type is DNS AMP:<br>
DDoS PoC recorded, you'll see tons of these in action :)
 <div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>1 11018 11020 mmd 3u IPv4 19591952 0t0 TCP x.x.x.x:44103-&gt;1.1.1.1:sunrpc (SYN_SENT)</code></pre></div> <br>
Analysis</div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/file1436.php?id=7811">sample.7z</a></div>
			<small><i class="fa fa-pencil"></i> 7z,pwd:infected</small><br>			<small><i class="fa fa-download"></i> (711.49 KiB) Downloaded 78 times</small>
		</div>
		
								</div>
										</div>
										
																					<div class="notice text-muted">
						 <small>Last edited by <a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a> on Thu Sep 11, 2014 3:08 am, edited 2 times in total.</small>
						 						 <div><small></small></div>
						</div>
																
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile23858">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815"><img src="kmdata/9c64b2fac870b9970a34651e3db5fe06.png" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						501
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Thu Apr 12, 2012 4:53 pm
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p23859" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p23859">Re: Linux/Elknot (Windows DDoS botnet, alias DnsAmp)</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopic5ff3.html?p=23859#p23859" title="Post">#23859</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Thu Sep 11, 2014 3:02 am 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content23859">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content">It looks like the crooks are following our twitter &amp; virus total :)<br>
The next week AFTER the previously posted sample, they changed the sample. It makes another variant :D<br>
Sample: <a href="https://www.virustotal.com/latest-scan/38bec940f641c8c6c9d9c3741691dc18940fcbc9d1f8e09f2d23c4b1ee389335" class="postlink">https://www.virustotal.com/latest-scan/ ... b1ee389335</a> 
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>File : txman
MD5    : 15642a0c5b4821e13991ed51acbf5a51
SHA256 : 38bec940f641c8c6c9d9c3741691dc18940fcbc9d1f8e09f2d23c4b1ee389335 </code></pre></div> <br>
So this is what happened↓
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>-rw-r--r--  1 mmd mmd 1153640 Jul 30 13:03 txman-packed</code></pre></div>smaller size? Why?
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>0000   7F 45 4C 46 01 01 01 03 00 00 00 00 00 00 00 00    .ELF............
0010   02 00 03 00 01 00 00 00 68 A2 D1 00 34 00 00 00    ........h...4...
0020   00 00 00 00 00 00 00 00 34 00 20 00 02 00 28 00    ........4. ...(.
0030   00 00 00 00 01 00 00 00 00 00 00 00 00 10 C0 00    ................
0040   00 10 C0 00 44 9A 11 00 44 9A 11 00 05 00 00 00    ....D...D.......
0050   00 10 00 00 01 00 00 00 DC 04 00 00 DC 04 2B 08    ..............+.
0060   DC 04 2B 08 00 00 00 00 00 00 00 00 06 00 00 00    ..+.............
0070   00 10 00 00 81 9C 52 92 55 50 58 21 DA 07 0D 0C    ......R.UPX!....</code></pre></div>:D I really feel being insulted by this moronz..<br>
so..
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
   2492151 &lt;-   1153640   46.29%  netbsd/elf386  txman-unpacked</code></pre></div>
This was successfully making this ELF becoming FUD again <img class="smilies" src="kmdata/sad.png" alt=":-(" title="Sad" height="24" width="24">(( And below header comparison explained a lot..<br>
<br>
Before depack:<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>  Magic:   7f 45 4c 46 01 01 01 03 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2s complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - Linux
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           Intel 80386
  Version:                           0x1
  Entry point address:               0xd1a268
  Start of program headers:          52 (bytes into file)
  Start of section headers:          0 (bytes into file)
  Flags:                             0x0
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         2
  Size of section headers:           40 (bytes)
  Number of section headers:         0
  Section header string table index: 0

Program Headers:
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
  LOAD           0x000000 0x00c01000 0x00c01000 0x119a44 0x119a44 R E 0x1000
  LOAD           0x0004dc 0x082b04dc 0x082b04dc 0x00000 0x00000 RW  0x1000

There are no sections in this file.
There is no dynamic section in this file.
There are no relocations in this file.
There are no unwind sections in this file.
No version information found in this file.</code></pre></div>
And after depack:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2s complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           Intel 80386
  Version:                           0x1
  Entry point address:               0x8048130
  Start of program headers:          52 (bytes into file)
  Start of section headers:          2491188 (bytes into file)
  Flags:                             0x0
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         5
  Size of section headers:           40 (bytes)
  Number of section headers:         24
  Section header string table index: 23

  Section Headers:
    [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
    [ 0]                   NULL            00000000 000000 000000 00      0   0  0
    [ 1] .note.ABI-tag     NOTE            080480d4 0000d4 000020 00   A  0   0  4
    [ 2] .init             PROGBITS        080480f4 0000f4 000030 00  AX  0   0  4
    [ 3] .text             PROGBITS        08048130 000130 0bde0c 00  AX  0   0 16
    [ 4] __libc_freeres_fn PROGBITS        08105f40 0bdf40 000ffa 00  AX  0   0 16
    [ 5] .fini             PROGBITS        08106f3c 0bef3c 00001c 00  AX  0   0  4
    [ 6] .rodata           PROGBITS        08106f60 0bef60 018720 00   A  0   0 32
    [ 7] __libc_subfreeres PROGBITS        0811f680 0d7680 00002c 00   A  0   0  4
    [ 8] __libc_atexit     PROGBITS        0811f6ac 0d76ac 000004 00   A  0   0  4
    [ 9] .eh_frame         PROGBITS        0811f6b0 0d76b0 0195b0 00   A  0   0  4
    [10] .gcc_except_table PROGBITS        08138c60 0f0c60 004725 00   A  0   0  4
    [11] .tdata            PROGBITS        0813e388 0f5388 000010 00 WAT  0   0  4
    [12] .tbss             NOBITS          0813e398 0f5398 000020 00 WAT  0   0  4
    [13] .ctors            PROGBITS        0813e398 0f5398 000024 00  WA  0   0  4
    [14] .dtors            PROGBITS        0813e3bc 0f53bc 00000c 00  WA  0   0  4
    [15] .jcr              PROGBITS        0813e3c8 0f53c8 000004 00  WA  0   0  4
    [16] .data.rel.ro      PROGBITS        0813e3e0 0f53e0 000814 00  WA  0   0 32
    [17] .got              PROGBITS        0813ebf4 0f5bf4 000078 04  WA  0   0  4
    [18] .got.plt          PROGBITS        0813ec6c 0f5c6c 00000c 04  WA  0   0  4
    [19] .data             PROGBITS        0813ec80 0f5c80 16a0f4 00  WA  0   0 32
    [20] .bss              NOBITS          082a8d80 25fd74 007748 00  WA  0   0 32
    [21] __libc_freeres_pt NOBITS          082b04c8 25fd74 000014 00  WA  0   0  4
    [22] .comment          PROGBITS        00000000 25fd74 0004da 00      0   0  1
    [23] .shstrtab         STRTAB          00000000 26024e 0000e4 00      0   0  1</code></pre></div>
Shortly, I can PoC the reversed CNC by below, yes we have NEW CNC by the same moronz, see how our test machine info was sent :D
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>connect(3, {sa_family=AF_INET, sin_port=htons(10991), sin_addr=inet_addr("60.173.10.184")}, 16) = -1 EINPROGRESS (Operation now in progress)
setsockopt(3, SOL_SOCKET, SO_SNDTIMEO, "\17\0\0\0\0\0\0\0", 8) = 0
send(3, "\270\v\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0Linux 3.2.0-4-a"..., 401, 0</code></pre></div> And it is CHINA (oh not again!! ;))
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>60.173.10.184||4134 | 60.168.0.0/13 | CHINANET | CN | CHINATELECOM.COM.CN | CHINANET ANHUI PROVINCE NETWORK</code></pre></div> <br>
DoS PoC:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>1 13042 14225 mmd 3u IPv4 19591952 0t0 TCP x.x.x.x:44103-&gt;1.1.1.1:sunrpc (SYN_SENT)</code></pre></div>

#MalwareMustDie!</div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/filecbae.php?id=7812">samples.7z</a></div>
			<small><i class="fa fa-pencil"></i> 7z, pwd:infected</small><br>			<small><i class="fa fa-download"></i> (1.68 MiB) Downloaded 80 times</small>
		</div>
		
								</div>
										</div>
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile23859">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815"><img src="kmdata/9c64b2fac870b9970a34651e3db5fe06.png" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						501
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Thu Apr 12, 2012 4:53 pm
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p23862" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p23862">Re: Linux/Elknot (Windows DDoS botnet, alias DnsAmp)</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopicbf0c.html?p=23862#p23862" title="Post">#23862</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Thu Sep 11, 2014 4:37 am 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content23862">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content">This "Elknot" is trying to get into victim server via Apache Struts.<br>
Case: <a href="http://yinette.github.io/blog/2014/09/02/it-all-began-with-a-struts-exploit-attempt/" class="postlink">http://yinette.github.io/blog/2014/09/0 ... t-attempt/</a><br>
I reversed in here: <a href="http://pastebin.com/949Y8a3g" class="postlink">http://pastebin.com/949Y8a3g</a><br>
<br>
Nothing special except after gaining shell via Struts exploit it tried 
to gain the root by using kernel exploit then downloading the payload 
(the malware that I reeversed) the Elknot, in x32 or x64: <a href="https://gist.github.com/anonymous/c947a9c3109a5fe353e8" class="postlink">https://gist.github.com/anonymous/c947a9c3109a5fe353e8</a><br>
And that is for installing these malware properly..<br>
VT:<br>
x32: <a href="https://www.virustotal.com/en/file/bb4786695774ae7777200a78e56db83ad5d5bdf1c1b84ef86dd796f7c9a3e1b4/analysis/1409687242/" class="postlink">https://www.virustotal.com/en/file/bb47 ... 409687242/</a><br>
x64: <a href="https://www.virustotal.com/en/file/d2b3ce2195b1422c165faeb1fbbdd098f13df6cf6595fb18f8d618cd78df597c/analysis/1409729124/" class="postlink">https://www.virustotal.com/en/file/d2b3 ... 409729124/</a><br>
<br>
CNC: 
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>connect(3, {sa_family=AF_INET, sin_port=htons(54460), sin_addr=inet_addr("61.147.103.21")}, 16) 
send(3, "\270\v\0\0\0N.%EN.%E\20'`\352MMD-IS-BANGING-YOU-B1TCH! x.x.x.x"..., 401, 0)</code></pre></div></div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/file1b21.php?id=7815">samples.7z</a></div>
			<small><i class="fa fa-pencil"></i> 7z,pwd:infected</small><br>			<small><i class="fa fa-download"></i> (834.87 KiB) Downloaded 73 times</small>
		</div>
		
								</div>
										</div>
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile23862">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815"><img src="kmdata/9c64b2fac870b9970a34651e3db5fe06.png" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						501
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Thu Apr 12, 2012 4:53 pm
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p23872" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p23872">Re: Linux/Elknot (Windows DDoS botnet, alias DnsAmp)</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopice3cf.html?p=23872#p23872" title="Post">#23872</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlistf915.html?mode=viewprofile&amp;u=6658" style="color: #595959;" class="username-coloured">malwarelabs</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Fri Sep 12, 2014 12:55 pm 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content23872">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content">Two other samples.<br>
Filename:  shyen ae4bd538136d7df53c60353e8b6e87b8 <a href="https://www.virustotal.com/en/file/a42f850aef178128cb69e87efa78add9b7d45f465eef07ca7fd888283509f106/analysis/1410526240/" class="postlink">https://www.virustotal.com/en/file/a42f ... 410526240/</a> <br>
Filename: uhdyp 659194bdd0fc16ec9c037c9f59af4a3d <a href="https://www.virustotal.com/en/file/44ec385b20a12e137ee1f74e5e395db5b2c22f1740275363e0f83a39a129c2c6/analysis/1410526313/" class="postlink">https://www.virustotal.com/en/file/44ec ... 410526313/</a><br>
<br>
Originaly packed with UPX. Unpacked sample in attachment</div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/file4cf3.php?id=7821">samples.zip</a></div>
			<small><i class="fa fa-pencil"></i> infected</small><br>			<small><i class="fa fa-download"></i> (1.02 MiB) Downloaded 75 times</small>
		</div>
		
								</div>
										</div>
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile23872">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlistf915.html?mode=viewprofile&amp;u=6658"><img src="kmdata/9c64b2fac870b9970a34651e3db5fe06.png" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlistf915.html?mode=viewprofile&amp;u=6658" style="color: #595959;" class="username-coloured">malwarelabs</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						44
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Tue Dec 10, 2013 9:07 am
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p23873" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p23873">Unclassified Linux backdoor</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopic27ca.html?p=23873#p23873" title="Post">#23873</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist9290.html?mode=viewprofile&amp;u=327" style="color: #595959;" class="username-coloured">K_Mikhail</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Fri Sep 12, 2014 7:20 pm 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content23873">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content"><a href="https://www.virustotal.com/ru/file/909a4ce95893ea16075ea478abcff3d6c34b1c90e91640a1fb718116cf8abf86/analysis/1410549449/" class="postlink">https://www.virustotal.com/ru/file/909a ... 410549449/</a><br>
<a href="https://www.virustotal.com/ru/file/7d2b073f6c7dfe2b135bbec85eb15ad949c537382710374b82ce151601a63af4/analysis/1410549460/" class="postlink">https://www.virustotal.com/ru/file/7d2b ... 410549460/</a><br>
<br>
source: pingyan-china.com</div>
					
										<div class="clearfix">
											<div class="attachbox">
						 <h5>Attachments</h5>
										
				
				
				<div class="file">
			<div><i class="fa fa-paperclip fa-flip-horizontal"></i> <a class="postlink" href="https://www.kernelmode.info/forum/download/file1dff.php?id=7822">elf.7z</a></div>
			<small><i class="fa fa-pencil"></i> pw:virus</small><br>			<small><i class="fa fa-download"></i> (20.01 KiB) Downloaded 75 times</small>
		</div>
		
								</div>
										</div>
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile23873">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist9290.html?mode=viewprofile&amp;u=327"><img src="kmdata/9c64b2fac870b9970a34651e3db5fe06.png" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist9290.html?mode=viewprofile&amp;u=327" style="color: #595959;" class="username-coloured">K_Mikhail</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						41
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Tue Apr 13, 2010 4:13 pm
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>
  <div id="p23875" class="clearfix">	
    <article>
  <div class="well well-sm forum-answer">
    <div class="row">
	    <div class="postbody col-md-9 col-sm-8 col-xs-12">
		  <div class="clearfix">
			<div class="pull-right">
			<div role="toolbar" class="btn-toolbar">
									 
							 
						</div>
			</div>
			
			<div class="pull-left">
		     <h3><a href="#p23875">Linux/Elknot (DDoS botnet) | Re: Unclassified Linux backdoor</a></h3>
		    </div>
		  </div>
			
		<div class="clearfix">
			<div class="pull-left timepost">
			<i class="fa fa-bookmark"></i>&nbsp;<a href="https://www.kernelmode.info/forum/viewtopic1dfa.html?p=23875#p23875" title="Post">#23875</a>&nbsp;<i class="fa fa-user"></i>&nbsp;by&nbsp;<strong><a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a></strong> 
			<br><i class="fa fa-clock-o"></i>&nbsp;Sat Sep 13, 2014 6:26 am 
			</div>
		</div>
		
		<div class="space10"></div>	
			
            <div id="post_content23875">

										
										
					<span class="hidden hook-bfr-message"></span>
					<div class="content"><blockquote><cite>K_Mikhail wrote:</cite><a href="https://www.virustotal.com/ru/file/909a4ce95893ea16075ea478abcff3d6c34b1c90e91640a1fb718116cf8abf86/analysis/1410549449/" class="postlink">https://www.virustotal.com/ru/file/909a ... 410549449/</a><br>
<a href="https://www.virustotal.com/ru/file/7d2b073f6c7dfe2b135bbec85eb15ad949c537382710374b82ce151601a63af4/analysis/1410549460/" class="postlink">https://www.virustotal.com/ru/file/7d2b ... 410549460/</a><br>
source: pingyan-china.com</blockquote>
First, thank you very much for the kindly share!. I posted the reply, 
but looks like the topic has been thankfully merged so I re-typed 
comment:<br>
<br>
This is exactly the ARM version that previously I reported here:  <a href="https://www.kernelmode.info/forum/viewtopic54df.html?f=16&amp;t=3099#p23874" class="postlink">http://www.kernelmode.info/forum/viewto ... 099#p23874</a><br>
Your sample is Intel x32 ones, so assembly is much more familiar than 
the ARM version, yet has some a bit adjustment related to the Intel 
version.  I would say that ARM version was designed for that purpose and
 these samples are generic versions. <br>
PoC of the similarity is in many codes, i.e., in here: (see the /dev/null used)
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>.text:0x804BBF8  push    offset file     ; "/dev/null"
.text:0x804BBFD  call    _open
.text:0x804BC02  add     esp, 10h
.text:0x804BC05  sub     esp, 8
.text:0x804BC08  push    2               ; oflag
.text:0x804BC0A  push    offset file     ; "/dev/null"
.text:0x804BC0F  call    _open
.text:0x804BC14  add     esp, 10h
.text:0x804BC17  sub     esp, 8
.text:0x804BC1A  push    2               ; oflag
.text:0x804BC1C  push    offset file     ; "/dev/null"
.text:0x804BC21  call    _open</code></pre></div>
and here: (the template used to send info to remote)
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>.text:0x804AA42  push    ebp
.text:0x804AA43  mov     ebp, esp
.text:0x804AA45  sub     esp, 408h
.text:0x804AA4B  sub     esp, 0Ch
.text:0x804AA4E  push    ds:usage
.text:0x804AA54  push    ds:netuse
.text:0x804AA5A  push    offset aInfoDD  ; "INFO:%d|%d"
.text:0x804AA5F  push    400h            ; maxlen
.text:0x804AA64  lea     eax, [ebp+buf]
.text:0x804AA6A  push    eax      </code></pre></div>
and in here:<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code> (the /etc/.msys) file created 
.text:0x804BD38  push    ebp
.text:0x804BD39  mov     ebp, esp
.text:0x804BD3B  sub     esp, 18h
.text:0x804BD3E  mov     [ebp+file], offset aEtc_mysys ; "/etc/.mysys"
.text:0x804BD45  sub     esp, 8
.text:0x804BD48  push    42h             ; oflag
.text:0x804BD4A  push    [ebp+file]      ; file
.text:0x804BD4D  call    _open
.text:0x804BD52  add     esp, 10h
.text:0x804BD55  mov     [ebp+fd], eax
.text:0x804BD58  cmp     [ebp+fd], 0
.text:0x804BD5C  jg      short loc_804BD67
.text:0x804BD5E  mov     [ebp+var_C], 0
.text:0x804BD65  jmp     short loc_804BD8B</code></pre></div>and many other minor spots too.<br>
<br>
For the different and additional details is as per below:<br>
<br>
In this Intel version they tried to "convince" this as "WinHelp32 Remote
 Control Tool's Service", I am not Microsoft system expert but never 
hear such name before ))
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>0x044AC    WinHelp32.exe
0x044CC    WinHelp32
0x04530    WinHelp32 Service
0x04594    WinHelp32 Remote Control Tool's Service</code></pre></div>
Attack method named (some use new names with a compete same crap as other Elknot(s))
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>DNSFlood
SynFlood
StreamFlood
WebWXCCFlood
ICMPFlood
UDPFlood</code></pre></div>
Compiled source code and include files used suggesting new build, minor variant..or different crook.
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>crtstuff.c
auto_start.c
main.c
signal_process.c</code></pre></div>
Compilation include header/lib files (the one goes with #define/#include):
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code> utime.h
 types.h
 stat.h
 time.h
 Head.h
 DDos.h
 netdb.h
 sockaddr.h
 tcp.h
 stdio.h
 libio.h
 stddef.h
 select.h
 socket.h
 unistd.h
 utsname.h
 kernel.h
 pthreadtypes.h</code></pre></div>
Compiled environment:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>GNU C 3.4.6 20060404 (Red Hat 3.4.6-9)</code></pre></div>
Dependency:
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>/lib/ld-linux.so.2'
/lib/libpthread.so.0
/lib/libc.so.6</code></pre></div>

CNC is below.. we're dealing with malware amateur programmer yet know how to code well here..
<div class="codebox"><span>Code:&nbsp;<a href="#" onclick="selectCode(this); return false;">Select all</a></span><pre><code>61.147.103.21||65222 | 61.147.103.21/32 | -Private |  | CHINATELECOM.COM.CN | CHINANET JIANGSU PROVINCE NETWORK </code></pre></div>This
 malware is not whole new in design, yet is new in compilation/build. 
Right was released in the same timing with the same ARM version few days
 before, thanks for finding this.  It uses many previous Elknot 
tricks/codes. But with more simplification. Maybe to support multi arc 
compilation..who knows. Whoever coded this, his project has just been 
started..<br>
<br>
Comment to generally Elknot: Recently this malware family spotted a lot 
in many hacked servers. Variants are changing fast, we saw many new 
functions, obfuscation, evasion, are implemented in each campaign. 
Please help to post more samples so we all can trace well the progress 
of this threat. With thank you in advance.</div>
					
										
																										
            </div>
					</div>
			<div class="col-md-3 col-sm-4 hidden-xs">
			  <div class="user-profile-tab">
				<div id="profile23875">
				<div class="user-profile-avatar">
								<div class="avatar-frame">
											<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815"><img src="kmdata/9c64b2fac870b9970a34651e3db5fe06.png" alt="User avatar" height="90" width="90"></a>										</div>
					
						
					 									</div>
				 				

				<div class="user-profile-row">
					    <div class="user-profile-tag">Username</div>
				    <div class="user-profile-output">
						<a href="https://www.kernelmode.info/forum/memberlist9c8d.html?mode=viewprofile&amp;u=2815" style="color: #595959;" class="username-coloured">unixfreaxjp</a>					</div>
				</div>
				
								
								<div class="user-profile-row">
					    <div class="user-profile-tag">Posts</div>
				    <div class="user-profile-output">
						501
					</div>
				</div>
								
					
				<div class="user-profile-row">
					    <div class="user-profile-tag">Joined</div>
				    <div class="user-profile-output">
						Thu Apr 12, 2012 4:53 pm
					</div>
				</div>
								
				
								
																
							    								
				</div>
			  </div>
		    </div>
    </div>
		   </div>
</article>
 
</div>




 <div class="pull-right">
     <ul class="pagination pagination-sm hidden-xs">
	 	<li><a title="" href="javascript:void(0);" data-target=".sorting" data-toggle="collapse">Options</a></li>				
     	  <li class="active"><a>53 posts</a></li>
			
		<li class="active"><a>1</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd5fe.html?f=16&amp;t=3099&amp;start=10" role="button">2</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopic1c19-2.html?f=16&amp;t=3099&amp;start=20" role="button">3</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopiccaa5-2.html?f=16&amp;t=3099&amp;start=30" role="button">4</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopic9f02.html?f=16&amp;t=3099&amp;start=40" role="button">5</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd726.html?f=16&amp;t=3099&amp;start=50" role="button">6</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd5fe.html?f=16&amp;t=3099&amp;start=10" rel="next" role="button">Next</a></li>
	
		     </ul>
	 
	<div class="visible-xs"> 
	<ul class="pagination pagination-sm">
	 	 <li><a title="" href="javascript:void(0);" data-target=".sorting" data-toggle="collapse"><i class="fa fa-cog"></i></a></li>				
	 <li><a class="pagination-trigger" data-placement="top">Page <strong>1</strong> of <strong>6</strong></a></li>
	 <li class="active"><a>53 posts</a></li>
	</ul>
	</div>
 </div>
</div>

<div class="clearfix">
   <div class="pull-right">
	<div class="visible-xs"> 
	 <ul class="pagination pagination-sm">
	 			
		<li class="active"><a>1</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd5fe.html?f=16&amp;t=3099&amp;start=10" role="button">2</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopic1c19-2.html?f=16&amp;t=3099&amp;start=20" role="button">3</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopiccaa5-2.html?f=16&amp;t=3099&amp;start=30" role="button">4</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopic9f02.html?f=16&amp;t=3099&amp;start=40" role="button">5</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd726.html?f=16&amp;t=3099&amp;start=50" role="button">6</a></li>
			<li><a href="https://www.kernelmode.info/forum/viewtopicd5fe.html?f=16&amp;t=3099&amp;start=10" rel="next" role="button"><i class="fa fa-chevron-right"></i></a></li>
	
			 </ul>
	</div>
   </div>
</div>

<div class="space10"></div>
<div class="pull-left">
	<a href="https://www.kernelmode.info/forum/viewforumf2fa.html?f=16" accesskey="r"><i class="fa fa-chevron-left"></i>&nbsp;Return to “Malware”</a>
</div>
<div class="space10"></div>
<div class="space10"></div>

    		<form method="post" action="https://www.kernelmode.info/forum/viewtopic.php?f=16&amp;t=3099">
		   <div class="hidden-xs">
	<fieldset class="controls-row">
        <div class="sorting collapse">
			<div class="panel panel-default">
				<div class="panel-body">
					 <div class="row">
					
						<div class="col-md-3 col-sm-3"> 
                         <label for="st">Display:</label>
                            <div class="control-row">
                              <select class="selectpicker" data-width="100%" data-style="btn btn-default form-control" data-container="body" name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>
                            </div>
						</div>
	                    <div class="col-md-3 col-sm-3"> 
                          <label for="sk">Sort by:</label>
                            <div class="control-row">
                              <select class="selectpicker" data-width="100%" data-style="btn btn-default form-control" data-container="body" name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select>
                            </div>
						</div>				
						<div class="col-md-3 col-sm-3">  
                           <label for="sd">Sort by:</label>
                            <div class="control-row">
							<div class="input-group">
                             <select class="selectpicker" data-width="100%" data-style="btn btn-default form-control" data-container="body" name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>
							 <span class="input-group-btn">
                              <button class="btn btn-default" name="sort" type="submit">Go</button>
							</span>
							</div>
						    </div>   
						</div>
					
					<div class="col-md-3 col-sm-3"> 
                      <label accesskey="j">Jump to:</label>
                       <div class="control-row">
                         <div id="jumpbox" class="dropdown">
  <button class="btn btn-default btn-block dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="true">
   Select the forum to jump to
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu jumpbox-dropdown" role="menu" style="width: 100%;">
  <!-- <li role="presentation" class="dropdown-header">Dropdown header</li> -->
    	 		 	 <li role="presentation" class="jumpbox-cat-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum814c.html?f=29">Main</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum957d.html?f=8">&nbsp;&nbsp;&nbsp;&nbsp;Announcements</a></li>
	 		 	 <li role="presentation" class="jumpbox-cat-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum9df8.html?f=31">General</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforumf2fa.html?f=16">&nbsp;&nbsp;&nbsp;&nbsp;Malware</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforumffeb.html?f=20">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malware Requests</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum740d.html?f=21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Completed Malware Requests</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum8a83.html?f=11">&nbsp;&nbsp;&nbsp;&nbsp;Tools/Software</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforumeb13.html?f=13">&nbsp;&nbsp;&nbsp;&nbsp;Reverse Engineering and Debugging</a></li>
	 		 	 <li role="presentation" class="jumpbox-cat-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum48ab.html?f=17">Development</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum9780.html?f=14">&nbsp;&nbsp;&nbsp;&nbsp;Kernel-Mode Development</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforumb09f.html?f=15">&nbsp;&nbsp;&nbsp;&nbsp;User-Mode Development</a></li>
	 		 	 <li role="presentation" class="jumpbox-cat-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum5579.html?f=30">Other</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum12a3.html?f=2">&nbsp;&nbsp;&nbsp;&nbsp;General Discussion</a></li>
	 		 	 <li role="presentation" class="jumpbox-sub-link"><a role="menuitem" tabindex="-1" href="https://www.kernelmode.info/forum/viewforum15ca.html?f=10">&nbsp;&nbsp;&nbsp;&nbsp;Newbie Questions</a></li>
	 	  </ul>
</div>	
                       </div>
					</div>
                   </div>
                </div>
			</div>
		</div> 
	</fieldset> 
</div></form>		
	




<footer> <!-- Footer block -->
    	
</footer>
	
	</div><!-- page-body id in header -->
  </div> <!-- padding_0_40 in header -->
  <!-- content-forum in header -->
 <!-- wrap - corners container in header -->

<a id="totop" class="topstyle" href="#" onclick="return false;" style="display:none;"><i class="fa fa-chevron-up"></i></a>

<div class="container">
  <div class="copyright">
	<small class="pull-left">
						<!-- <a href="http://www.sitesplat.com/phpBB3/">BBOOTS</a> -->
	</small>
	<small class="pull-right">
			<!-- &nbsp;&#45;&nbsp;All times are <span title="UTC">UTC</span>&nbsp;&#45;&nbsp; -->
		
	</small>
  </div>
</div>

<div class="hidden"></div> 

<!-- injected via core and ajax JS for the return confirmation actions -->
   <div id="page-footer">
	<div id="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="alert alert-default phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<button type="button" class="close alert_close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>
		<h3 class="alert_title">&nbsp;</h3>
		 <p class="alert_text"></p>
	</div>
	
	<div id="phpbb_confirm" class="alert alert-default phpbb_alert">
		<button type="button" class="close alert_close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>
		<div class="alert_text"></div>
	</div>
  </div>	
<!-- injected via core and ajax JS for the return confirmation actions -->


<script>
// this loads jquery asyncrounously & in parallel
head.load("../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js", "../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js", "styles/BBOOTS/theme/vendors/forum_fn.min.js");
</script>

<!-- we use this event to load the JS scripts properly via the extension system -->

<!-- injected via a module or an include -->
<script>
// some function that depends on bootstrap and jquery
head.ready(function () {
	$('.footable').footable();$(".selectpicker").selectpicker();$(".selectpicker").tooltip("disable");var totop=$("#totop");totop.click(function(){$("html, body").stop(true,true).animate({scrollTop:0},500);return false});$(window).scroll(function(){if($(this).scrollTop()>600){totop.fadeIn()}else{totop.fadeOut()}});$("button[data-loading-text], input[data-loading-text], .btn-load").click(function(){var e=$(this);e.button("loading");setTimeout(function(){e.button("reset")},3e3)});
	$("input").iCheck({checkboxClass:"icheckbox_minimal-grey",radioClass:"iradio_minimal-grey"});$(".btn-search").click(function(){$(".search-input").toggleClass("open").find("input").focus()});$(".close").click(function(){$(this).prev("input").val("").parents(".search-input").removeClass("open")});$(".nav-tog").click(function(){if($(this).hasClass("neutro")){$(this).removeClass("neutro").addClass("open")}else{$(this).removeClass("open").addClass("neutro")}});
	$('input[data-reset-on-edit]').on('keyup', function() {$(this.getAttribute('data-reset-on-edit')).val('');});
	$('a').tooltip({trigger : 'hover',container: 'body'})
    $('#notification_list_button').click(function(){setTimeout(function(){$(".nano").nanoScroller();},0);});	
});
// some function that depends on bootstrap and jquery
</script>
<!-- injected via a module or an include -->



<!-- // lets load the plupload crap super huge files becuase... wait for it wait for it. "swear here" -->
<script>
// lets load the plupload crap super huge files becuase... wait for it wait for it. "swear here"
head.ready(function () {
//<![CDATA[
phpbb.plupload = {
	i18n: {
		'b': 'B',
		'kb': 'KB',
		'mb': 'MB',
		'gb': 'GB',
		'tb': 'TB',
		'Add Files': 'Add\u0020files',
		'Add files to the upload queue and click the start button.': 'Add\u0020files\u0020to\u0020the\u0020upload\u0020queue\u0020and\u0020click\u0020the\u0020start\u0020button.',
		'Close': 'Close',
		'Drag files here.': 'Drag\u0020files\u0020here.',
		'Duplicate file error.': 'Duplicate\u0020file\u0020error.',
		'File: %s': 'File\u003A\u0020\u0025s',
		'File: %s, size: %d, max file size: %d': 'File\u003A\u0020\u0025s,\u0020size\u003A\u0020\u0025d,\u0020max\u0020file\u0020size\u003A\u0020\u0025d',
		'File count error.': 'File\u0020count\u0020error.',
		'File extension error.': 'File\u0020extension\u0020error.',
		'File size error.': 'File\u0020size\u0020error.',
		'File too large:': 'File\u0020too\u0020large\u003A',
		'Filename': 'Filename',
		'Generic error.': 'Generic\u0020error.',
		'HTTP Error.': 'HTTP\u0020error.',
		'Image format either wrong or not supported.': 'Image\u0020format\u0020either\u0020wrong\u0020or\u0020not\u0020supported.',
		'Init error.': 'Init\u0020error.',
		'IO error.': 'IO\u0020error.',
		'Invalid file extension:': 'Invalid\u0020file\u0020extension\u003A',
		'N/A': 'N\/A',
		'Runtime ran out of available memory.': 'Runtime\u0020ran\u0020out\u0020of\u0020available\u0020memory.',
		'Security error.': 'Security\u0020error.',
		'Select files': 'Select\u0020files',
		'Size': 'Size',
		'Start Upload': 'Start\u0020upload',
		'Start uploading queue': 'Start\u0020uploading\u0020queue',
		'Status': 'Status',
		'Stop Upload': 'Stop\u0020upload',
		'Stop current upload': 'Stop\u0020current\u0020upload',
		"Upload URL might be wrong or doesn't exist.": 'Upload\u0020URL\u0020might\u0020be\u0020wrong\u0020or\u0020does\u0020not\u0020exist.',
		'Uploaded %d/%d files': 'Uploaded\u0020\u0025d\/\u0025d\u0020files',
		'%d files queued': '\u0025d\u0020files\u0020queued',
		'%s already present in the queue.': '\u0025s\u0020already\u0020present\u0020in\u0020the\u0020queue.'
	},
	config: {
		runtimes: 'html5',
		url: './posting.php?mode=reply&f=16&t=3099',
		max_file_size: '10244588b',
		chunk_size: '1048576b',
		unique_names: true,
		filters: [{title: 'Images', extensions: 'gif,png,jpeg,jpg,tif,tiff,tga'},{title: 'Archives', extensions: 'gtar,gz,tar,zip,rar,ace,torrent,tgz,bz2,7z'},{title: 'Plain_text', extensions: 'txt,c,h,cpp,hpp,diz,csv,ini,log,js,xml'},{title: 'Documents', extensions: 'xls,xlsx,xlsm,xlsb,doc,docx,docm,dot,dotx,dotm,pdf,ai,ps,ppt,pptx,pptm,odg,odp,ods,odt,rtf'}],
		
		headers: {'X-PHPBB-USING-PLUPLOAD': '1', 'X-Requested-With': 'XMLHttpRequest'},
		file_data_name: 'fileupload',
		multipart_params: {'add_file': 'ADD_FILE'},
		form_hook: '#qr_postform',
		browse_button: 'add_files',
		drop_element : 'message',
	},
	lang: {
		ERROR: 'Error',
		TOO_MANY_ATTACHMENTS: 'TOO_MANY_ATTACHMENTS',
	},
	order: 'desc',
	maxFiles: 10,
	data: [],
}
//]]>
head.load("assets/plupload/plupload.full.min.js", "styles/BBOOTS/theme/vendors/plupload.min.js");
});
</script>

<!-- Google Analytics: change UA-XXXXXXXX-X to be your site's ID. -->




</body><!-- Mirrored from www.kernelmode.info/forum/viewtopic.php?f=16&t=3099 , Sun, 01 Dec 2019 16:50:43 GMT --></html>
